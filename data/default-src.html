<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>User Specified Content Security Policy</title>
    <link href="tabs.css" rel="stylesheet" type="text/css" />

<!-- Global Tables to store user CSP and website CSP -->
<script>
// Two dimensional array structure for userCSPArray and websiteCSPArray
// user/websiteCSPArray[domainName][0] = default-src 
// user/websiteCSPArray[domainName][1] = script-src
// user/websiteCSPArray[domainName][2] = object-src
// user/websiteCSPArray[domainName][3] = image-src
// user/websiteCSPArray[domainName][4] = media-src
// user/websiteCSPArray[domainName][5] = style-src
// user/websiteCSPArray[domainName][6] = frame-src
// user/websiteCSPArray[domainName][7] = font-src
// user/websiteCSPArray[domainName][8] = xhr-src
// user/websiteCSPArray[domainName][9] = frame-ancestors

var userCSPArray= {}; // stores user defined CSP in array format
var userCSPAll = {}; // stores user defined CSP without array format

var websiteCSPArray = {}; // stores website defined CSP in array format
var websiteCSPAll = {}; // stores website defined complete CSP as it is.  

// To remember the previously selected Domain in onchange event
var oldDomainValue = "all";

// To remember the previous selected directives in onchange event
var oldDirectiveValue = 0;

var previousTabId = 0; // Stores value of previous tab id

</script>

 <!-- Script file to send data to main add-on -->
 <script src="send-data.js"></script>

<!-- Script file to process UI  -->
<script src="default-src.js"></script>

 <!-- Script file to receive data from main add-on -->
 <script src="recv-data.js"></script>


 <!-- Inline script to give look and feel of Tab panel -->
 <!-- <script> -->
 <!--  function changeDirective(element) { -->
 <!--    // If user clicks on selcted tab then ignore it. -->
 <!--    if (element.parentNode.className === "current") -->
 <!--     return; -->

 <!--    // Look and feel of changing the CSP directive tab -->
 <!--    var liList = document.getElementById('toc').getElementsByTagName("li");     -->
 <!--    for (var i=0; i < liList.length; i++) { -->
 <!--      if (liList[i].id === element.parentNode.id) {                 -->
 <!--        liList[i].className="current"; -->
 <!--      } else  { -->
 <!--        liList[i].className=""; -->
 <!--      } -->
 <!--    } // end of FOR loop -->
   
 <!--   // Change the title of the CSP directive tab -->
 <!--   document.getElementById('directiveName').innerHTML = element.parentNode.id; -->

 <!--   // Clear input elements -->
 <!--   document.getElementById("rule1").value = "";   -->
 <!--   document.getElementById("rule1UserList").options.length=0;     -->
 <!--  } // end of changeDirective function -->
 <!-- </script> -->


</head>
<body>
<h1>CSP Policy <input type='button' style="float: right" id='exitUserCSP' value='Exit' onclick='exitCSP(event);' /></h1>

<p>
     <label>Select Domain To Apply CSP Rules </label>
     <select id="domainName" size="1" style="width:220px" onchange="getDomainChoice(event);">
        <option value="all">*(Every Website)</option>
      </select>
      <script>
         getforAll();
      </script>
      <br />
     <label>User Rules For Selected Domain </label>
     <input type="radio" Name="stateGroup" id="cspRuleEnable" value="Enable"  onclick="swapCSPStateForDomain(this);"> <label for="cspRuleEnable"> Enable </label>
       <input type="radio" Name="stateGroup" id="cspRuleDisable" value="Disable" onclick="swapCSPStateForDomain(this);"> <label for="cspRuleDisable"> Disable </label>
</p>

<div class="content">
    <h2 id="directiveName">Directives</h2>
    
    <ol id="toc">
    <li id="All-policies"><a  href="#" onclick="changeDirective(this, -1);">All</a></li>
    <li id="Default-Src" class="current"><a  href="#" onclick="changeDirective(this, 0);">default-src</a></li>
    <li id="Script-Src"><a  href="#" onclick="changeDirective(this, 1);">script-src</a></li>
    <li id="Object-Src"><a  href="#" onclick="changeDirective(this, 2);">object-src</a></li>
    <li id="Image-Src"><a  href="#" onclick="changeDirective(this, 3);">img-src</a></li>
    <li id="Media-Src"><a  href="#" onclick="changeDirective(this, 4);">media-src</a></li>
    <li id="Style-Src"><a  href="#" onclick="changeDirective(this, 5);">style-src</a></li>
    <li id="Frame-Src"><a  href="#" onclick="changeDirective(this, 6);">frame-src</a></li>
    <li id="Font-Src"><a  href="#" onclick="changeDirective(this, 7);">font-src</a></li>
    <li id="Xhr-Src"><a  href="#" onclick="changeDirective(this, 8);">xhr-src</a></li>
    <li id="Frame-Ancestors"><a  href="#" onclick="changeDirective(this, 9);">frame-ancestors</a></li>
</ol>

     <!-- <select id="cspDirectives" style="width:220px" onchange="storeDirectiveData(this);"> -->
    <!--   <option value="0">default-src</option> -->
    <!--   <option value="1">script-src</option> -->
    <!--   <option value="2">object-src</option> -->
    <!--   <option value="3">img-src</option> -->
    <!--   <option value="4">media-src</option> -->
    <!--   <option value="5">style-src</option> -->
    <!--   <option value="6">frame-src</option> -->
    <!--   <option value="7">font-src</option> -->
    <!--   <option value="8">xhr-src</option> -->
    <!--   <option value="9">frame-ancestors</option> -->
    <!-- </select> -->

    <br />

     <!-- ----------------CSP Directives Tab UI ----------------------->
    <div id="dynamicDirDiv">
      <p><label for='rule1'>Enter Rule: </label> <input type='text' id='rule1' value=''  /> &nbsp;&nbsp; <input type='button' id='addRule1btn' value='Add' onclick='listenData(event);' /></p>

      <p><table width='100%' border='0' cellspacing='0' cellpadding='0'>
          <tr> <td align='center'> 
              <label for='rule1WebsiteList'>Website Specified Rules</label> </td>
            <td align='center'> <label for='rule1UserList'>User Specified Rules </label> </td></tr> 
          <tr> <td align='center'> 
              <select multiple='multiple' id='rule1WebsiteList' style='width:220px'>
                <!-- <option value='self'>*.example.com</option> --> 
            </select> </td>  
            <td align='center'> 
              <select multiple='multiple' id='rule1UserList' style='width:220px'> </select> </td></tr> 
          <tr>  <td align='center'> 
              <input type='button' id='removeRule1Optionsbtn' value='Add to User Rule' onclick='addData(event);' /> </td>  
            <td align='center'> 
              <input type='button' id='removeRule1btn' value='Remove' onclick='removeData(event);' /> </td> </tr>
          <tr>  <td> &nbsp;</td>  <td> &nbsp;</td>   </tr>
      </table> </p>

      <p align='right'><input type='button' id='applyRule1btn' value='Apply User Rules' onclick='applyUserRules()' /></p>
    </div>


    <!-- ---------------- All Tab UI ------------------------------>
    <div id="dynamicAllTabDiv" >
      <br />
      <label for='websiteCompleteCSP'><b>Website CSP Rules:</b> </label>
      <label id='websiteCompleteCSP'></label>  <br /><br />   
      <label for='userCompleteCSP'><b>User CSP Rules:</b> </label>    
      <label id='userCompleteCSP'></label> <br /><br />  
      <label for='combinedWUCSP'><b>Combined Rules:</b> </label>  
      <label id='combinedWUCSP'></label> <br /><br />  
      <input type='radio' Name='group1' id='combineStrictRule1btn' value='S' onclick='combineStrict();' /> 
      <label for='combineStrictRule1btn'> Combine Strict </label> 
      <input type='radio' Name='group1' id='combineLooseRule1btn' value='L' onclick='combineLoose();' />
      <label for='combineLooseRule1btn'> Combine Loose </label> 
      <p align='right'>  
        <input type='button' id='applyCombinedRule1btn' value='Apply Combined Rules' onclick='applyCombinedRules();' /> </p>
    </div>
     
    <script>
      var AllTabDIV = document.getElementById("dynamicAllTabDiv");
      AllTabDIV.style.display ='none';      
    </script>

</div> <!-- end of DIV class content -->
</body>
</html>
