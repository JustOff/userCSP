\section{Introduction}
\label{sec:background}

The web browsers security model is rooted in the sameorigin policy
(SOP) ~\cite{sop}, which isolates resources of one origin from
others. However, attackers can subvert the SOP by injecting malicious
contents into a vulnerable website; this is known as Cross-site
scripting (XSS) attacks~\cite{xss}. Cross-site Scripting (XSS) attacks
in web applications are considered a major threat. XSS allows an
attacker to conduct a wide range of potential attacks, such as session
hijacking, stealing sensitive data and passwords, creation of
self-propagating JavaScript worms, etc. To mitigate XSS attacks,
Content Security Policy (CSP)~\cite{csp} provide website
administrators with a way to enforce content restrictions at the
client side.

Content Security Policy is a declarative policy that restricts what
content can be loaded on a web page. Its primary purpose is to
mitigate Cross-Site Scripting vulnerabilities.  The core issue
exploited by Cross-Site Scripting (XSS) attacks is that web browsers
lack the knowledge to distinguish between content that's intended to
be part of a web application, and content that's been maliciously
injected into a web application. To address this problem, CSP defines
the {\tt Content-Security-Policy} HTTP header that allows web application
developers to create a whitelist of trusted content sources, and
instruct the client browsers to only execute or render resources from
those sources. However, it is often difficult for developers to write
a comprehensive Content Security Policy for their website. They may
worry about their page breaking because unanticipated but necessary
content is blocked. They may not be able to easily change the headers
their site is sending when these situations occur, which makes it
difficult for them to try different policies until they find one that
is the most restrictive for their page without breaking site
functionality.

UserCSP changes this! A developer or user can now view the current
policy set by their site and add their own policy.  They can choose to
apply their custom policy on the site, or even combine their policy
with the websiteâ€™s existing policy.  When combining policies, they
have an option to choose from the strictest subset of the two, or the
most lax subset.  They can locally test their site with the custom
policy applied and tweak the policy until they have one that works.

UserCSP also allows automatic inference of a Content Security Policy
for a website. Automatically inferred policies for a website help web
developers figure out what CSP rules to set for their site by giving
them the strictest possible policy they could apply without breaking
the current page.  To infer the CSP policy for a website, UserCSP
analyzes the content on the current web page and recommends a CSP
based on the content types and content sources. UserCSP provides this
inferred policy to developers in the proper syntax for the CSP header,
so all a developer needs to do is start serving this policy for their
site via the CSP header. [Moreover, it allows users to enforce
  inferred policy on the website.-REMOVE] Furthermore, UserCSP allows
savvy users to voluntarily specify their own Content Security Policy
for websites that may not have implemented CSP.

In summary, this paper makes the following contributions:

\begin {itemize}

\item We present an automated approach, UserCSP, for writing a Content
  Security Policy for a website.

\item UserCSP allows savvy users to voluntarily specify their own
  Content Security Policy for websites that may not have implemented
  CSP.

\item We implemented a prototype of our approach in a Firefox
  extension.

\end{itemize}
