\section {Implementation of \codename}
\label{sec:imp}

We implemented \codename \footnote[1]{UserCSP Source Code:
  https://github.com/patilkr/userCSP} in Firefox extension using the
Jetpack SDK v1.9~\cite{JetPack-SDK}. \Codename intercepted various events like the "READY",
"ACTIVATE", and "CLOSE" events on tab. The ready event is used to
retrieve a list of open websites in a user's Firefox web browser. The
activate event is used to select the currently active domain in the
web browser. The close event is used to remove the domain name from
the UI if a user closes the tab. \Codename used sqlite database to
store user specified CSP policies for websites.

The "http-on-examine-response" observer notification is used to
intercept the HTTP response. In the intercepted response, the domain
that initiated the request is checked against the sqlite local
database to determine whether user defined rules. If there are no
rules associated with the website, the response is processed without
any change. However, if user defined CSP rule exists, the
"Content-Security-Policy" header is added to the response with the
rules specified by user. It replaces the existing
"Content-Security-Policy" header if it is already set by website.


